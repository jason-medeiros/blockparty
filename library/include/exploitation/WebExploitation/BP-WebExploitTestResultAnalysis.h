/*
 * BP-WebExploitTestResultAnalysis.h
 *
 *  Created on: Apr 7, 2009
 *      Author: root
 */

#ifndef BPWEBEXPLOITTESTRESULTANALYSIS_H_
#define BPWEBEXPLOITTESTRESULTANALYSIS_H_

// Thist structure is utilized for holding analysis match results in
// a table of indexes with point into the test array which is being analyzed.
typedef struct _BP_WEB_ANALYSIS_RESULT_INDEX_SET {
	size_t * matchIndexes;
	size_t   matchCount;
} BP_WEB_ANALYSIS_RESULT_INDEX_SET, *P_BP_WEB_ANALYSIS_RESULT_INDEX_SET;


// Returns an analysis index set which contains the matches for the given
// format tests.
P_BP_WEB_ANALYSIS_RESULT_INDEX_SET BP_WebAssessmentRunTests(P_BP_WEB_ASSESSMENT assessment, BP_FMT_ERR_TESTS * tests, size_t testCount);

// Utilizes the data stored within the session in order to attempt a match with
// a given XSS Test. (FORM VERSION)
P_BP_WEB_XSS_TEST_RESULT BP_WebAssessmentRunXSSFormMatchCheck
(
		P_BP_WEB_ASSESSMENT  assessment,
		P_BP_WEB_XSS_TEST    test,
		size_t               testIndex,
		size_t               runMagicQuotesTest,
		P_BP_HTML_FORM_LIST  form,
		P_BP_HTML_INPUT_LIST vulnInput,
		size_t               inputVarPosition
);


#endif /* BPWEBEXPLOITTESTRESULTANALYSIS_H_ */
