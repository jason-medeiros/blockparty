/*
 * BP-WebExploitPHPErrCodes.h
 *
 *  Created on: Apr 7, 2009
 *      Author: root
 */

#ifndef BPWEBEXPLOITPHPERRCODES_H_
#define BPWEBEXPLOITPHPERRCODES_H_

/*
 * JM Note: The php error codes have been gleened from the PHP sources as
 * php developers are an incompetant bunch of bastards who have no sense of
 * convention whatsoever when it comes to documentation of sources.  That being
 * said, the errors/warnings which are found here are as accurate as i could get
 * by grepping out the sources.  If any errors need to be reported i'll be talking
 * to myself anyway unless for some strange reason this software has been bought
 * by another company.  If that is the case, im probabaly rich already, which is
 * an awesome thing.  In that case, send me an email or w/e and we can talk about
 * it.
 */

// Basically just an array of pointers, but kept in a structure to maintain
// a sense of convention + the ability to expand capacity between builds.
typedef struct _BP_PHP_ERR_CODES {
	char *phpErrStr;
} BP_PHP_ERR_CODES, *P_BP_PHP_ERR_CODES;


// Generates an allocated array of PHP error codes
P_BP_PHP_ERR_CODES BP_PHPGenErrCodeArray();

// Generates a list of error code tests based around the
// error code array defined above.  This set is basically
// a string array w/o format strings.
P_BP_FMT_ERR_TESTS BP_PHPGenErrTestsFromErrCodeArray(P_BP_PHP_ERR_CODES inCodes, size_t numCodes, char **fmtReplacementTable);

// Returns the total number of checks within the PHP array.
size_t BP_PHPErrCount();

// %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
// %%%%%%%%%%%% DECONSTRUCTORS %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

// Destroys a set of PHP error code allocations
size_t BP_DestroyPHPErrCodes(BP_PHP_ERR_CODES * codes);

#endif /* BPWEBEXPLOITPHPERRCODES_H_ */
