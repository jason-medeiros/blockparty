/*
 * BP-WebExploitMsqlErrCodes.h
 *
 *  Created on: Apr 3, 2009
 *      Author: root
 */

#ifndef BPWEBEXPLOITMSQLERRCODES_H_
#define BPWEBEXPLOITMSQLERRCODES_H_

typedef struct _BP_MSQL_ERR_CODES {

	char *errNum;
	char *severity;
	char *logged;
	char *description;

} BP_MSQL_ERR_CODES, *P_BP_MSQL_ERR_CODES;


// Error testing structure
typedef struct _BP_MSQL_ERR_TESTS{

	// an array of strings used for matching error
	// codes in buffers relating to msql test matches.
	char **msqlErrTestStrs;

	// the number of strings in the above test array
	size_t numStrs;

} BP_MSQL_ERR_TESTS, *P_BP_MSQL_ERR_TESTS;


// Generates an allocated array of Msql error codes
P_BP_MSQL_ERR_CODES BP_MsqlGenErrCodeArray();

// Generates a list of error code tests based around the
// error code array defined above.  This set is basically
// a string array w/o format strings.
P_BP_FMT_ERR_TESTS BP_MsqlGenErrTestsFromErrCodeArray(P_BP_MSQL_ERR_CODES inCodes, size_t numCodes, char **fmtReplacementTable);

// Returns the total number of checks within the msql array.
size_t BP_MsqlErrCount();

// %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
// %%%%%%%%%%%% DECONSTRUCTORS %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

// Destroys a set of MSQL error code allocations
size_t BP_DestroyMSQLErrCodes(P_BP_MSQL_ERR_CODES codes);


#endif /* BPWEBEXPLOITMSQLERRCODES_H_ */
