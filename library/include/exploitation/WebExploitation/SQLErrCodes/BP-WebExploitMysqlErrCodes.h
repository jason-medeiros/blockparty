/*
 * BP-WebExploitMysqlErrCodes.h
 *
 *  Created on: Apr 2, 2009
 *      Author: root
 */

#ifndef BPWEBEXPLOITMYSQLERRCODES_H_
#define BPWEBEXPLOITMYSQLERRCODES_H_

// Do not modify contents of this structure
typedef struct _BP_MYSQL_ERR_CODES {

	// MYSQL String Error Define
	char *myqlErrCode;

	// Mysql String Error Content
	char *mysqlErrStr;

} BP_MYSQL_ERR_CODES, *P_BP_MYSQL_ERR_CODES;


// Error testing structure
typedef struct _BP_MYSQL_ERR_TESTS{

	// an array of strings used for matching error
	// codes in buffers relating to mysql test matches.
	char **mysqlErrTestStrs;

	// the number of strings in the above test array
	size_t numStrs;

} BP_MYSQL_ERR_TESTS, *P_BP_MYSQL_ERR_TESTS;


// Generates a newly allocated error code array
P_BP_MYSQL_ERR_CODES BP_MysqlGenErrCodeArray();

// Generates a list of error code tests based around the
// error code array defined above.  This set is basically
// a string array w/o format strings.
P_BP_FMT_ERR_TESTS BP_MysqlGenErrTestsFromErrCodeArray(P_BP_MYSQL_ERR_CODES inCodes, size_t numCodes, char **fmtReplacementTable);

// number of tests in the array
size_t BP_MysqlErrCount();

// %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
// %%%%%%%%%%%% DECONSTRUCTORS %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

// Destroys a set of MySQL Tests
size_t BP_DestroyMySQLErrCodes(BP_MYSQL_ERR_CODES * codes);

#endif /* BPWEBEXPLOITMYSQLERRCODES_H_ */
